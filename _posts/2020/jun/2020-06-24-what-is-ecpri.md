---
title: "eCPRI 는 무엇인가?"
tags: [eCPRI]
---

CPRI에 이어 eCPRI라는 것이 나왔다. 뭐하는 것이냐고? CPRI란 게 쉽게 말해 기지국과 안테나간 (이것은 backhaul의 상대적인 개념으로 fronthaul이라고 한다) 기저대역 신호를 주고 받는데 사용한 일종의 규약이었다고 하면 eCPRI는 그것의 진화된 형태? 라고 보면 된다.

안테나에서 받는 신호는 아날로그 신호일텐데 그걸 어떻게 규격으로 만드느냐 할 수 있는데, 말이 그렇지 안테나에서 받은 신호를 기저대역 (반송파 주파수를 0 Hz로 떨어뜨린 신호 = 기저대역 신호 (baseband signal))로 바꾸고 그걸 전부 양자화 (quantize) 해 놓은 것이라 쉽게 말해 순수하게 통신 시스템 신호를 디지털의 형태로 가지고 있는 것을 기지국과 주고 받게 해놓은 신호 포멧? 패킷 포멧? 그리고 프로토콜 (어떻게 주고 받는 쪽에서 handshaking을 하는지를 규졍한) 이라고 보면 된다.

CPRI라는 것이 처음 나온 게 기억도 안날 정도로 오래전 일인데, CPRI가 보급 될 때만 해도 뭐랄까 '이런 게 이제야 나온 건가?' '왜 이쪽 부분은 표준화가 이렇게도 안되고 있는 건가?' 했던 기억이 있다. 통신 관련 표준도 어떤 분야는 엄청나게 빨리 만들고 바뀌고 하지만 어떤 분야는 정말로 지지부진하고 허접함을 면치 못하는 부분이 있다. 사실 당시에 CPRI가 나왔지만 CPRI를 실현할 수 있는 모든 토대가 다 마련되어있었어도 CPRI를 따르지 않고 제조사 마음대로 만들었었다. 그걸 다 뜯어보면 좀 한심한 모양새를 했었는데, 어차피 뜯어볼 수 있는 사람도 없을 뿐더러 뜯어서 불만을 품어봤자 제조사가 그렇게 하겠다는데 바꿔줄리도 만무했거니와 그걸 CPRI와 같은 표준을 따르게 해놓으면 third party가 들어와서 일정 분량의 파이를 먹어버릴 것이라 생각했기 때문에 더 그러했다.

이제 eCPRI는 CPRI와 근본적으로 뭐가 다른가를 얘기해야할 것 같다. 

CPRI는 3G의 chip rate = 3.84 Mcps 를 기준으로 만들어진 메시지 포멧을 가지고 있다. 그러니까 주고 받는 데이터가 1/3.84MHz 주기로 동일 형태의 데이터 프레임이 전송되도록 되어있다. 여기에 baseband 신호를 넣어서 보내면 꽉 차지 않고 약간의 여유가 생기는데 거기에 별도의 사용자 메시지를 끼워넣을 수 있게끔 배려되있는 정도이다.

여기서 사용자 신호라 함은 기저대역 신호가 아닌 기지국과 안테나 (말이 안테나지 안테나 시스템, radio remote head, RRH, radio head 등등 부르는 이름은 다양하다)가 주고 받는 제어신호 (이것은 CPRI에서 특별히 정의하지 않았으니까 제조사별로 자유롭게 정해서 쓸 수 있다고 본다.)를 말한다. 제어 신호라고 함은 RRH의 설정을 실시간으로 바꾸려고 할 때의 정보라든가, RRH가 기지국로 올려보낼 측정 데이터 값등을 의미한다고 보면 된다.

eCPRI도 이 기본 골격은 다르지 않다. 1/3.84MHz 주기로 되어있는 패킷안에 baseband signal과 user message가 구겨들어가 있는 모양새를 하고 있다. 

그런데, 중요한 차이점은 이게 ethernet을 통해서 보내지게 되어있고, UDP를 통해서 보내지는 데다 compress/decompression을 할 수 있다는 것이다. Spec상에서 명확하게 comp/decomp를 어떻게 한다라는 것이 정해져있지 않다. 다시말해서 이 부분은 제조사 마음대로 할 수 있는 것이다. 

NR을 가정하면 안테나에서 받은 신호를 적당히 압축해서 (여기서는 I/Q라는 표현을 구체적으로 쓴다. IQ compression이라고 명시하고 있다) UDP packet에 실어서 ethernet을 통해 주고 받게 된다. NR 신호로 보자면 OFDMA 1개 심볼 정도의 길이의 데이터로 쪼개져서 날아오게 된다. 압축방법은 부분적인 floating point (exponent + mantissa)로 주고 받을 수도 있고 매우 고전적인 방법인 u-law (mu-law) 알고리즘같은 것을 쓸 수도 있을 것이다. 

그런데 한가지 궁금한 점은 과연 이런 baseband signal을 압축하면 도무지 효율이 얼마나 높을 수 있을까 하는 것이다. 이게 무손실 압축이 아니라 분명히 성능이 까일텐데 내가 봐온 바로는 다들 어떻게든 압축을 하려고 하는 것 같다. 일종의 로그변환 같은 것이라고 본다. 즉, 다이내믹 레인지가 큰 신호를 로그변환 (혹 이와 비슷한 테이블을 이용해서) 해서 쉽게 말해 y축을 축소해놓는 것과 같은 것이다. u-law도 따지면 그 비슷한 것이라고 볼 수 있고. floating point 변환도 log 변환을 섞어놓은 것이니까. 카메라로 따면 Sony HLG라든가 S-Log2/3 뭐 이런 것과 비슷한 맥락이라고 볼 수 있다.

나머지 어떻게 동기화를 하고 어떤 기준으로 time-out이 되는지 등등의 사항은 스펙을 참조하시라. 