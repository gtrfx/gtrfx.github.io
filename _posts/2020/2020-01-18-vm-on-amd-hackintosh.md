간편하게 Linux상에서 QEMU/KVM, MacOS 상에서 Parallels Desktop/VMware Fusion을 올려보고 여기에 아무런 변형을 가하지 않고 있는 그대로의 상태에서 윈도우즈를 설치한 뒤에 Geekbench 5를 돌려봤다.

두괄식으로 결론을 먼저 말하자면 암드해킨에서는 VMware Fusion으로 윈도우즈를 설치해서 사용하되 코어수는 3-4개 정도 할당해서 쓰는 것이 최적이다.


0. Linux QEMU/KVM

가상머신을 제대로 돌리면 어떻게 되는지 보기 위해 실험한 것인데, Native 상태에서 1090/7300 정도의 score를 얻는데, KVM 상에서는 984/6330 정도의 점수를 얻었다. PCIe bypass를 하면 고사양 게임도 충분히 돌릴 수 있을 것으로 본다. 

1. Parallels Desktop

최신 버전은 15까지 나왔고 암드해킨에서 버전 14 또는 15를 적용하면 대개 같은 버전내에서는 윈도우즈 설치화면도 가보지 못하고 에러를 맞이하게 된다. 구버전은 된다는 얘길 듣고 버전 13을 돌려봤는데, 윈도우즈 설치도 되고 뭔가 되는구나 하는 모습은 볼 수 있지만,

- 일단 윈도우즈가 설치되면 윈도우즈가 하는 일이 없어도 parallels 프로세스는 기본적으로 100%의 로드를 늘 잡아먹음
- 해당 가상머신에 16개의 thread (가상머신에서는 16개 core)를 할당해줘도 윈도우즈 풀로드 상태에서 시스템 점유율은 200% 전후가 됨. 
- 이미 100%을 기본으로 점유하고 있으므로 가상머신의 실제 컴퓨팅 파워는 thread 1개 분량밖에 나오지 않음

결론적으로 암드해킨 상에서는 쓸 게 못 된다. 

2. VMware Fusion

암드해킨 사용자 포럼을 돌아보면 최신버전인 11에서는 동작하지 않는데 버전 10까지는 사용이 가능하다기에 버전 8과 10을 받아서 테스트 해봤다.

- 윈도우즈 설치 잘 됨
- 윈도우 부트시 또 부팅 직후 시스템 부하가 할당한 코어에 대해 최대로 치솟는 반면 진행은 빠르지 않음
- 가상머신 옵션 중에 intel hypervisor 활성화 옵션이 있는데 암드해킨에서 이것을 켜놓으면 시스템 속도가 크게 저하되고 화면 깜박임이 생김
- Core를 4개 이상으로 늘려주면 오히려 성능이 저하되는 현상을 보임 (효율상으로는 Core 3개가 적당한 것을 보임)
- 버전 8과 10의 차이는 미미한 것으로 보임.

코어를 많이 할당하더라도 hypervisor 기능을 사용할 수 없어서인지 벤치 스코어가 980/2500이상을 넘지 않는다. 

그래서, 얼마안되는 실험 결과를 종합하면
- AMD의 SVM 기능을 제대로 사용하는 가상머신 (QEMU/KVM)의 경우 native 성능의 80% 이상을 얻을 수 있다.
- MacOS에서 인텔 CPU를 타겟으로 한 Hypervisor를 실행하는 최근 버전의 가상 머신은 암드해킨에서 사용하기 어렵다.
- VMware Fusion의 구버전 (10 혹은 그 아래)을 사용하면 윈도우즈를 사용할 수 있는데, 이 때 인텔 hypervisor 기능은 꺼두고 3-4 core를 할당하면 아쉬운대로 최적의 성능을 얻을 수 있었다.

즉, 암드해킨에서 VM으로 윈도우즈를 쓰려한다면 아쉽지만 VMware에서 3-4개 코어를 할당해두고 쓰는 것이 지금까지 최적의 솔루션으로 보여진다. 

