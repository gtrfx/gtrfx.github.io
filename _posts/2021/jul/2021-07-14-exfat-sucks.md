---
title: "exFAT 말고 뭘 써야되나??"
layout: post
tags: [crappy exfat]
---

요즘 가장 흔한 파일 시스템은 아마도 다음 중 하나가 아닐까 하는데..

1) NTFS (Windows)
2) APFS (Mac)
3) EXT4(2) (Linux)
4) exFAT
5) FAT32

FAT32는 진작에 퇴물이 되었지만 EFI 파티션에 쓰이고 있고 (UEFI가 읽을 수 있는 간단한 것이어야 하니) exFAT이 OS와 상관없이 쓸 수 있는 만능 파일 시스템으로 자리잡은 것처럼 보인다.

문제는 exFAT이 umount가 좀 잘 못 되거나 하면 fsck를 돌려버려야 되는 지경에 이른다는 것이다. 경험 상으로 보면 umount가 꼭 잘 못 되지 않아도 쳐박아두었던 HDD를 물려서 뭔가 백업 좀 받으려고 하면 내내 말썽이라 이것 때문에 버려지는 시간이 정말 만만찮다는 것이다. 그나마 repair가 잘되면 모르겠는데 windows에서만 잘 되고 나머지 OS에서는 뭔가 고치는 둥 마는 둥 한다는 거다. linux에서 fsck를 하면 지나치게 시간을 끌고 그렇다고 다른 OS에 가져다 쓸 때 완벽하게 되는 것도 아니고 또 마찬가지로 Mac에서도 뭔가 고치는 것 같아 보이지만 실상은 별 차이 없는 그런 경우만 보게 되는 거다.

한마디로 말해서 exFAT은 다른 파일 시스템에 비해서 매우 약하다. 왜? journaling을 하지 않으니까. journaling이 뭐냐고? 기록할 때 마다 별도의 기록 장소에 다른 정보를 또 써넣는 작업이다. 그래서 뭔가 문제가 생기더라도 같이 기록된 다른 정보를 이용해서 복원해 낼 수 있다. APFS/HPFS(journaled)/EXT4 이런 아이들은 다 journaled라서 기록 중에 시스템이 죽었다거나 umount가 잘 못 되거나 하더라도 전체 파일 시스템이 바보가 되는 일은 좀처럼 생기지 않는다. 그러나 exFAT은 mount/umount를 아주 정갈하게 해줘도 다음 사용시에 mount가 안되는 일이 허다하다. 물론 repair도 깔끔하지 않고.

이렇게 exFAT과 친해지고 나면 절대로 쓰지 않게 되거나 어쩔 수 없이 쓰면서 불안해하거나 둘 중 하나가 된다. 한번 크게 당하면 절대로 안 쓸 것처럼 되지만 이내 그 사실을 잊고 다시 사용하게 되기도 하고 말이다.

일단 각자의 OS의 시각에서 바라보자면

1) Windows: NTFS/FAT32/exFAT 아니면 자동 인식되는 파일 시스템이 거의 없다.
2) Linux: exFAT이 kernel 수준에서 인식되기 시작한지 그다지 오래되진 않았다. 예전에도 그랬지만 Mac용 파일 시스템을 붙여서 쓸 때 그리 깔끔하지 못하다. 그렇다고 NTFS가 깔끔하지도 않고. 
3) Mac: EXT4는 붙일 수도 없고 NTFS는 답답하게 붙고 (원래 쓰기가 안되는데 다른 유틸의 도움을 받아야 되는데 이것도 그다지 완벽하진 않다) 역시나 답답하다.

개인적인 사용 경험으로는 APFS라든가 HPFS가 좋긴 하다. EXT4도 아주 좋다. 무슨 말이냐고? 어쩌다가 umount가 잘못되거나 해도 mount가 잘 되고 문제가 생겨도 repair를 빨리 할 수 있다.

Windows를 이제 VM으로만 사용하는 지경에 이르니 EXT4가 아니면 APFS 혹은 HPFS로 가야하는게 맞지 싶은데, 기존에 exFAT으로 백업해 둔 개인 자료가 어마어마해서 결국 또 새로운 외장 HDD를 구입해야 하는 것인가 하는 단계에 이르게 된다.

그건 그렇고, Windows VM을 쓰면서 exFAT을 repair할 수 있긴 하다. qemu만 예로 들어도 그냥 파일 시스템을 통째로 붙여버리면 된다. VM에서 자동으로 인식되고 거기서 repair를 하면 된다. 문제는 번거롭고 시간이 많이 든다는 거다. 사용할 때마다 repair를 해야되는 파일 시스템을 누가 좋아하겠나 아무리 호환성이 뛰어나다고 한들.

내가 또 exFAT을 쓰면 사람이 아니무니다.

Mac이 EXT4를 붙일 수 있게 해준다면 더 생각할 것도 없이 EXT4로 가겠다만 그럴 일은 절대 없을 것 같으니까.
