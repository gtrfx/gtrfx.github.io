---
layout: post
title: "Raspberry Pi external controller DIY (1)"
categories:
    - project
    - raspberry_pi
author: "Keith"
---

소형 파워앰프를 붙이 개인용 앰프 시뮬레이터를 만드려고 하다보니 결국 라스베리파이를 쓰는 상황에 이르렀고, 결과적으로 외부 컨트롤러가 필요해서 이미 여러 번 블로그에 언급한 바와 같이 다음의 부품들을 사용하기로 결정했다.

- 3개의 Rotary encoder
- 1개의 128x32 OLED display

이것들의 부품 값을 모두 합하면 대략 5천원 정도의 비용이 들어간다. 생각보다 128x32 디스플레이는 베달되어온 모양을 보니 너무너무 작았다. 손가락 한개 굵기보다 작은데 128x32로 찍을 수 있으니 필요한 메시지를 다 내보낼 수는 있긴 하다. 혹시 몰라서 128x64 디스플레이도 주문했는데 날아오는 중이라 (심천에서 내가 있는 곳으로 주문하면 언제 날아올지 전혀 알 수 없다. 트래킹이 전혀 안된다).

라스베리파이의 GPIO 핀아웃은 아래와 같다. 

![Pin out](/assets/images/pinout.png)

핀 모양을 다시 확인하니 배열이 나름 쓸만했다. 디스플레이와는 SPI를 이용하여 통신하는데 좌측 끝 6개 핀을 이용하면 일단 디스플레이를 켜고 소통하는 것이 가능하다. 

로터리 엔코더는 2개의 핀이 다이얼과 관련된 것이고 1개의 핀이 푸쉬버튼, 그리고 나머지 2개의 버튼이 전원핀인데, 라스베리파이의 GPIO의 입력 모드시 전압은 3.3 볼트로 기동하므로, 여기에 맞춰서 컨트롤러 모듈을 만들어야 한다. 잘 모르겠으나 전류제한/풀업 저항을 붙여줘야하나 C도 붙여줘야 하나 잘 모르겠다. 한국을 떠나온지 오래라 값싸고 좋은 부품을 빨리 구할 수가 없기 때문이다 ㅠ.

보드와의 컨넥션 및 소형 컨트롤러 보드를 조립해야 한다. 핀아웃 형상으로 봤을 때 중복되는 그라운드핀이 들어있어서 총 18핀을 써야 한다. 실제로는 13핀만 사용한다. 18핀용 female header가 없는 관계로 멀쩡한 헤더하나를 부숴야 할 것 같다.아니면 40핀 짜리 헤더를 찾아보든가.

사실 만들어봐야 크나큰 혁신이라고는 못해도 외부에서 컨트롤이 가능하다는 의미에서 큰 기대가 된다.

11/06/2017

OLED 액정을 받아보고 유심히 살펴보지 않았는데, 막상 뭔가 시작하려니 배송중에 문제가 생긴 것인지 액정이 파손되어 날아왔음을 알았다. 이베이 셀러에게 연락했는데 답이 없다. 이거 쉔젠에서 배송시키면 보름 정도 걸리는데, 기껏 받은 게 깨져있고, 나도 짜증, 셀러도 짜증나겠지. 

일단 모아서 찍어봤는데, 액정의 크기가 너무 작고 로터리엔코더와 노브는 사실 워낙 싼 부품이라 제대로 동작만 해도 OK다 싶다. 라스베리와 통신하는 핀은 2x10이면 되는데 그런 헤더도 없고 해서 부품통을 뒤져보니 예전 IDE 케이블이 있고 또 소켓도 있기에 아쉬운대로 그걸 쓰기로 했다. 웃긴 건 중간에 핀 구멍이 막혀있다는 것이다. 그래서 양쪽으로 해당 핀을 제거해서 연결해보았다. 잘 될 것 같다. 이제 컨트롤러 보드를 조립해야 되는데, 당장에 디스플레이로 활용할 액정이 없다. 아쉬운대로 없이 써야겠다.

저 버스라인은 추억을 떠올리게 한다. 요새 누가 저런 연결 케이블을 사용한단 말인가ㅋㅋ.

![Pin out](/assets/images/audvans_fs.jpg)