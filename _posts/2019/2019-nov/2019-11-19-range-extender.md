---
layout: post
title: "Range Extender in 5G systems"
tags: [range extender]
author: "Keith"
---

한국에서는 4G에 와서는 이통사들이 초반기에 엄청난 출혈경쟁을 하였기에 사실상 이동통신을 책이나 논문으로 배워온 사람들의 입장에선 다소 난감하긴 하지만 기지국 물량을 엄청 때려넣어서 아주 작은 홀에도 전부 다 새로운 cell이 생겨나게끔 그렇게 deploy를 해놨다.

무슨 말이냐면 4G 기지국을 (실제로는 기지국은 국사라고 불리우는 곳에 잔뜩 넣어두고 RRU라고 하는 장치) 설치할 때 일단 기존의 3G/2G를 위해 임대했던 곳이라든가 안테나를 설치했던 곳에 깔아둔 뒤에 field test를 해가면서 또 VOC를 받아가면서 부족한 곳에 계속해서 새로운 cell을 채워넣었단 말이다. 그래서 아무리 통신이 어려울 것 같은 구석진 곳에도 4G가 빵빵하게 들어오기에 이르른 것이다. 물론 그렇게 투자하지 않은 통신사의 경우는 여기 저기서 욕을 먹고 있을지도 모른다만.

그런 시절에 미국에 오니, 그것도 첨단 기술의 산실이라는 실리콘 벨리에 왔지만 이동통신 서비스는 형편없고 도시 외곽으로 나가면 edge와 같이 옛날 고리짝 시절의 2G 통신 시스템이 서비스된다는 사인을 폰에서 볼 수 있게 된다. 그래도 미국은 영국과 같은 이동통신서비스가 헐벗는 수준의 나라보단 나아서 아쉽긴 하지만 도심지에 제법 4G가 잘 들어오긴 한다만, 그래도 실내 깊숙히 들어가면 서비스가 잘 안되는 곳이 허다하다. 그래서 여기서는 개인이 자비를 들여서 Range extender라는 것을 놓는다. Wifi range extender라는 것은 좀 흔한 물건이다. 이 장치는 자신이 서비스 반경의 중간 혹은 끄트머리에서 4G 혹은 와이파이 신호를 받아서 다시 내보내는 기능을 한다고 볼 수 있다. 그래서 최종적으로는 더 넓은 범위로 서비스가 되게끔 하는 장치이다. 

그냥 단순하게 생각하면 자신이 받은 신호를 증폭해서 다시 내보내는 장치가 아닐까 생각할 수 있는데, 생각보다 그렇게 간단한 게 아니다. 

우리 나라에서는 예전 3G 시절에 중계기라는 물건이 있었는데, RF 중계기라고 해서 상향 (사용자 --> 기지국) 하향 (기지국 --> 사용자) 3G 신호를 스스로 라디오처럼 받아서 반대 방향으로 증폭해서 내보내는 방법으로 커버리지를 넓히기도 했고, 아예 기지국과 디지털 데이터 (baseband signal: 그러니까 RF로 주고 받는 신호를 0Hz로 끌어내린 순수한 통신 신호)를 광케이블로 주고 받게 해서, 그냥 개념적으로 보면 기지국에 붙어있는 안테나 하나를 먼곳으로 끌고가서 달아놓은 것과 같은 기능을 했다. 전자를 아날로그 중계기 후자를 디지털 중계기라고 부르기도 했고, 물론 기지국과 직접 대면하는 후자의 경우가 품질이 좋을 수 밖에 없다. 물론 여기엔 여러가지 부작용이 따르기도 한다. 3G에서는 closed loop power control이란 걸 했기 때문에 생각지도 않던 곳에 안테나가 생기면 (사실 이런 중계기를 붙여서 쓴다는 것은 생각도 못한 일이었으니까) 이게 실제 설계와 잘 맞아떨어지지 않아서 문제가 생기는데, 그런 세세한 문제들 다 해결한 덕택에 실내든 지하든 어디서든 3G가 잘도 빵빵 터졌다. 

영국의 지하철에서 3G/LTE가 터널이든 다리든 지날 때 그냥 끊어져나가던 기억을 떠올려보면 그런 세세한 곳에서 아쉽지 않게 해주는 것이 바로 고급 기술력이지 않을까 싶은데, 한국에서만 쭉 살아오고 외국엔 놀러다녀오는 사람들의 입장에서는 국내 통신시설이 얼마나 훌륭한지 알기 어렵지 싶다. 

4G에서도 3G 중계기 붙이듯이 이렇게 할 수 있는 것 아니냐 할 수 있는데, 마찬가지로 2가지 방법 다 할 수는 있다. 단지 거리가 어느 정도 이내가 되어야 한다는 조건이 붙는데, 이게 생각같지 않아서 중계기 대신에 그냥 새로운 기지국을 더 가져다 붙인다. 그러니까 있는 셀을 늘려 만드는 게 아니라 없던 셀을 하나 더 만드는 것이다. 우리나라는 도심지 어느 곳을 가더라도 광케이블로 유선망을 끌어올 수 있으니까 이 또한 어려운 일이 아니고, 사람들이 많이 모이는 곳에서 광랜 하나만 끌어오면 어디서든 LTE도 빵빵 터지게 되는 것이다. 사실 중계기로 고민하는 것보단 그냥 소형 기지국 하나를 붙이면 된다. 그래서 펨토셀이다 뭐다 한창 떠들었었다. 돈을 쓰기 싫어하는 나라에서는 피코셀이다 뭐다 해서 용량은 일반 기지국 정도이면서 크기가 작은 기지국을 사다가 음영지역을 해소하는 듯 하다. 말이 피코 기지국이고 소형 기지국이지 매크로 기지국을 대량으로 들여놓으면 돈이 더 들어갈까 싶고 기존 시스템을 뜯어고쳐야 되니 그렇게 하는 것이다. 우리 나라처럼 광케이블이 거미줄보다도 더 촘촘하게 깔린 곳이 흔하질 않으니까.

5G의 경우 FDD로 동작하기도 하고 TDD로 동작하게도 되지만 당장엔 TDD로 동작하는 것이 일반적이다. 전세계적으로 주파수 밴드에 대한 것은 표준으로 되어있고 FDD/TDD가 혼재되지 않고 특정 주파수 대역은 TDD 특정 대역은 FDD로 구분이 되어있다. 한국에서 사용하는 3.5 GHz 대역은 TDD로 사용하는 대역이라서, 이전에 사용하던 4G와는 달리 TDD로 서비스되는 것을 알 수 있다. 이 대역에서 최대한 쓸 수 있는 밴드폭은 100MHz이므로 LTE의 상 혹은 하향 최대 주파수 폭인 20MHz의 대략 5배쯤 되는 주파수 자원을 쓰게 되는데, 실제로는 5.5배가 되지만 상하향이 같이 쓰게 되니까 실제로는 그 절반인 2.75배라고 볼 수 있다. 

어쨌든 트래픽이 하향으로 모두 쏠린다거나 하면 명목적인 전송률로만 보면 15kHz당 최대 8bit (256 QAM), 그래서 SIMO로 전송한다면 739.2 Mbps, 2 layer MIMO라면 1.478Gbps, 4 layer라면 2.956Gbps 뭐 이런 식으로 될텐데, 어차피 통신이란 게 단방향으로 내려보내기만 할 수는 없고 이래 저래 overhead도 끼고 coding rate도 1로 가져갈 수 없고 MIMO도 내가 원하는 대로 다 될 수 있는 게 아니라, 대략 4 layer MIMO로 따져도 잘 나와야 2.xGbps 쯤 된다고 볼 수 있을 것이다. 물론 이것은 흔한 스마트폰으로 할 수 있는 일은 아니고 스펙상으로 최대 조건을 모두 가져갈 수 있는 시험용 단말에서만 가능한 일이다.

그런데 누가 떡하니 큰 아티클로 올려놓은 걸 보면 20Gbps가 가능해서 대충 2.x GBps 전송이 가능해지니 15GB짜리 영화를 6초에 받을 수 있다는 안드로메다 이야기를 하고 있는데, 만에 하나 이런 신호를 무선상에서 주고 받을 수 있다 하더라도 고사양의 PC도 이것을 받아낼 능력이 안되는 세상이니까 (일반인이 10GigE도 아닌 100GigE를 쓰는 이가 없다. 환경이 좋아봐야 1GigE다.) 개소리라고 할 수 있다. 2.x Gbps도 거의 이상적인 무선 환경에서나 가능한 일이니까 실생활에서 이게 벌어질리 없고, 또 같은 밴드를 여러 사람들과 나눠써야 하기 때문에 그냥 택도 없는 소리가 되는 것이다. 

이야기가 밖으로 새서 5G 이야기를 하다 말았는데, 5G에서는 range extension을 하는 것이 좀 중요한 문제가 될 수 있다. 한국처럼 물량을 엄청나게 때려넣는 곳 말고 미국처럼 넓은 곳이라거나 (사실 5G가 아무리 싸져도 넓은 곳으로 서비스할 일은 없다 여태도 그런 곳은 2G가 들어와도 감사할 지경이니까), 영국처럼 워낙에 서비스가 구려도 그냥 굴러가는 곳에서 5G 요금제를 쓰는데 '이거 좀 너무하는 거 아니냐' 하는 사람들을 위해서 말이다. 어차피 이런 짓 할 바에야 그냥 4G 쓰고 말지 하면 사실 할 말은 없다. 그런 곳에서는 4G도 제대로 안나오니까. 차라리 LTE femto를 놓거나 그냥 Wifi AP를 놓으면 된다. voice 통화를 꼭 LTE나 5G로 해야할 일이 없게끔 사업자들은 3G를 넓은 커버리지로 가져가고 있으니까 5G coverage extender를 만드는 것은 그냥 이런 맥락에서는 의미가 없게 느껴진다. 4G에서도 그럴 이유가 없었으니까. 

그래도 구태여 만들어야 된다, cell coverage를 extend 해야한다 한다면,
- TDD system 이므로 기지국과 시간 동기화가 이루어져야 한다. (적어도 cell search가 되고 매 slot마다 D/U ratio가 어느 정도인지 알고 있어야 됨): 단말의 cell search 기능은 기본으로 가지고 있어야 함
- 상하향 신호를 수신하기 위해서는 양방향으로 Beamformer를 구동해야 한다. 
- D/U에 맞춰서 송신을 위한 beamforming을 해야 효율을 높일 수가 있다. 
- 수신한 신호는 latency를 최소화해야 하므로 그대로 증폭해서 내보낸다 (되도록이면 analog signal을 그대로 이용한다). 

즉, digital부가 기지국(gNB) 신호의 동기, beamforming을 수행하고 analog부는 수신된 신호를 그대로 증폭하여 내보낸다.